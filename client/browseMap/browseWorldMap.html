<template name="browseWorldMap">

<script>
	function allowDrop(ev) {
	    ev.preventDefault();
	}

	function drag(ev) {

		gDontUpdateMap = true;

	    ev.dataTransfer.setData("text", ev.target.src);
	}

	function drop(ev) {


	    ev.preventDefault();

	    var map = display.ctl["MAP"].browseWorldMap.map;

	    var _long = map.stageXToLongitude( ev.offsetX );

	    var _lat = map.stageYToLatitude( ev.offsetY );

		var data = ev.dataTransfer.getData("text");

		var image = new AmCharts.MapImage();

        image.latitude = _lat;
        image.longitude = _long;

        image.width = 64;
        image.height = 64;
        image.imageURL = data;
  
        map.dataProvider.images.push(image);
        map.validateData();		

        var _ticket = game.user.getTicket( display.ctl["MAP"].browseWorldMap.selectedCountry.get() );

        _ticket.addTag( data, _long, _lat ); 

        db.updateUserHacks();
	    

	}
</script>

	<div style="position: relative; float: left; top: 55px; width:10%;">

		<div id="browseWorldIcon">
			<img class="topMapIcon" src="all_icon.png">
		</div>

		<div id="browseContinentIcon" class="mapLevel" >
			<img class="mapIcon" id="mapIconContinent" src="{{continentIcon}}"> 
			<div class="areaLabel" id="continentLabel">{{continentName}}</div>
		</div>

		<div id="browseRegionIcon" class="mapLevel">
			<img class="mapIcon" id="mapIconRegion" src="{{regionIcon}}"> 
			<span class="areaLabel" id="regionLabel" style="top: {{labelYCorrection}}">{{regionName}}</span>
		</div>

	</div>


	<div id="browseDivMap"  ondrop="drop(event)" ondragover="allowDrop(event)" style="float: left; position: relative; top: 55px; width: {{mapWidth}}px; height: {{mapHeight}}px; border-radius: 7px; border: 4px solid; border-color: gray;">
	</div>  

	<div class="mapTags" style="position: relative; top: 55px; width:8%;">

		{{#each tag}}

			<div>
				<img class="imgMapTag"   draggable="true" ondragstart="drag(event)"  id="tag1" src="{{this.url}}">
			</div>
		
		{{/each}}


	</div>

	<div class="mapMessages" id="browseMapMessageBox"></div>

	<button class="btn btn-default mapCloseButton" id="browseMapClose">X</button>


</template>




 